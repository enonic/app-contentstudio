apply plugin: 'com.github.node-gradle.node'

node {
    version = '18.12.1'
    download = true
}

task npmInstallForce( type: NpmTask ) {
    description = 'Update all project node dependencies'
    args = ['install', '--force']
}

task cleanNode( type: Delete ) {
    delete 'node_modules'
}

afterEvaluate {
    if ( configurations.hasProperty( 'devResources' ) )
    {
        task copyDevResources {
            doLast {
                copy {
                    from configurations.devResources.files.collect { zipTree( it ) }
                    include 'dev/**'
                    into '.xp'
                }
            }
        }

        npmInstall.dependsOn copyDevResources
    }
}